import{j as t,F as v,r as a,a7 as we,C as ge,a8 as ne,J as Ce,K as Ae,x as ye,y as _e,z as h,A as P,Q as ae,N as Oe,d as m,o as he,T as ie,a as ke,R as Z,U as ee,v as Pe,W as te,E as Fe,m as Re,s as Le}from"./index-Db1G4GFK.js";import{j as Me,k as ve,l as He,u as Ue,d as $e,n as Ge,c as Be,C as Ye,a as ze,F as je,B as Qe,g as Ve}from"./CustomFormDialog-CJNVvg9u.js";import{a as We,h as y,u as A,z as M,t as Ke,s as F,D as Xe,P as Je}from"./SnackbarDefaults-bH2yLHx5.js";import{i as qe,a as Ze,F as et}from"./index-DDiROGzA.js";import{f as tt,b as st,g as rt,h as at,e as it,a as se}from"./BookingInformationDialog-DxV8TDpZ.js";import{u as nt}from"./ShiftsApi-CqFIuQVz.js";import{a as Q}from"./SelectListShifts-CS2NmeDY.js";import{C as re}from"./Checkbox-BhZaxc1j.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},E=new Error().stack;E&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[E]="2a0f7bc9-0f72-463a-9f3b-820c3432379e",n._sentryDebugIdIdentifier="sentry-dbid-2a0f7bc9-0f72-463a-9f3b-820c3432379e")}catch{}})();const V=[Me,ve,He],ot=["Day","Night","Holiday"],lt=()=>[{key:"userName",title:"NAME",isConstantTranslation:!0},{key:"category",title:"TITLE",isConstantTranslation:!0},{key:"hasBookings",title:"SELECT",isConstantTranslation:!0}],dt=n=>n?t(v,{sx:{color:"primary.main"},size:24,children:"material-solid:check_box"}):t(v,{sx:{color:"primary.main"},size:24,children:"material-outline:check_box_outline_blank"}),ue=n=>{const{width:E}=We(),{day:R,shiftId:u,businessId:o,isDay:W,isNight:H,isHoliday:U,bookingId:I,endDate:oe,status:$}=n,[T,G]=a.useState(y(R,"yyyy-MM-DD").toDate()),[c,K]=a.useState(),_=A(we),O=A(ge),f=A(ne),X=A(Ce),N=A(Ae),l=ye(),[w,J]=a.useState({day:y(T).format("yyyy-MM-DD"),businessId:o}),B=tt(w,{refetchOnMountOrArgChange:!0}),[Y,z]=a.useState([]),j=nt(u,{refetchOnMountOrArgChange:!0}),L=Ue(o,{refetchOnMountOrArgChange:!0}),[s,e]=a.useState({}),[r,d]=a.useState({}),[b,x]=a.useState(""),[Se,ht]=a.useState({startDate:y(T).format("yyyy-MM-DD"),businessId:o}),le=st(Se,{refetchOnMountOrArgChange:!0}),[me,de]=a.useState([]),De={id:void 0,startDate:"",endDate:"",statusId:1,notes:""},pe=M.object({id:M.number().optional(),startDate:M.string(),endDate:M.string(),statusId:M.number().min(1),notes:M.string().min(1)}),be=_e({mode:"onChange",defaultValues:De,resolver:Ke(pe)}),{handleSubmit:ce,control:xe,formState:Ee}=be,{isValid:Ie,errors:Te,isDirty:Ne}=Ee;return a.useEffect(()=>{const{data:i,isLoading:g,isSuccess:S,isError:D,error:p,isFetching:k}=B;return l(h(g)),l(h(k)),S&&i&&i.map(C=>{z(q=>{var fe;return[...q,{userName:C.userName,category:((fe=C.subCategory)==null?void 0:fe.length)>0?C.subCategory:C.category,hasBookings:dt(C.hasBookings)}]})}),D&&p&&l(P(F(`${O.t("ERROR_LOADING_DATA")} ${f.t("USERS_PER_SHIFT")}`,"error"))),()=>z([])},[B]),a.useEffect(()=>{const{data:i,isLoading:g,isSuccess:S,isError:D,error:p,isFetching:k}=j;return l(h(g)),l(h(k)),S&&i&&e(i),D&&p&&l(P(F(`${O.t("ERROR_LOADING_DATA")} ${X.t("SHIFTS")}`,"error"))),()=>e({})},[j]),a.useEffect(()=>{const{data:i,isLoading:g,isSuccess:S,isError:D,error:p,isFetching:k}=L;return l(h(g)),l(h(k)),S&&i&&d(i),D&&p&&l(P(F(`${O.t("ERROR_LOADING_DATA")} ${N.t("BUSINESS_INFO")}`,"error"))),()=>d({})},[L]),a.useEffect(()=>{const{data:i,isLoading:g,isSuccess:S,isError:D,error:p,isFetching:k}=le;return l(h(g)),l(h(k)),S&&i&&i.map(C=>{de(q=>[...q,{dailyDate:y(C.dailyDate,"yyyy-MM-DD").toDate(),isFilled:C.isFilled}])}),D&&p&&l(P(F(`${O.t("ERROR_LOADING_DATA")} ${f.t("USER_SHIFTS")}`,"error"))),()=>de([])},[le]),a.useEffect(()=>{var g,S,D,p;let i="";return r?(W&&(i=`Day (${(g=Q[r.dayShiftStartHour])==null?void 0:g.label} - ${(S=Q[r.dayShiftEndHour])==null?void 0:S.label})`),H&&(i=`Night (${(D=Q[r.nightShiftStartHour])==null?void 0:D.label} - ${(p=Q[r.nightShiftEndHour])==null?void 0:p.label})`),x(`${r.area} - ${s.businessPhaseName} - ${s.name} - ${i}`)):x(""),()=>x("")},[s,r]),a.useEffect(()=>{K(y(T).format("Do MMMM YYYY")),J(i=>({...i,day:y(T).format("yyyy-MM-DD")}))},[T]),t(ze,{isDirty:Ne,isValid:Ie,actions:I&&$===rt.REQUESTED?[{title:_.t("CANCEL_BOOKING"),onClick:()=>{l(ae({children:t(at,{bookingId:I})}))},forceEnable:!0}]:[{title:O.t("CANCEL"),onClick:()=>l(Oe()),variant:"outlined",forceEnable:!0},{title:f.t("WAITING_LIST"),onClick:ce(i=>console.log(i))},{title:f.t("REQUEST_1_DAY"),onClick:ce(i=>console.log(i))}],title:c,subtitle:b,children:m("div",{className:"flex flex-col md:flex-row gap-12 w-[80vw] md:w-[70vw] lg:w-[60vw] xl:w-[40vw] px-12",children:[t("div",{className:"flex flex-col gap-12",children:Y.length>0?m(he,{children:[t(ie,{className:"font-bold",children:f.t("USER_SHIFT_DIALOG_BOX_TITLE")}),t("div",{className:"flex flex-row gap-12 justify-center py-8",children:me.map(i=>{const g=y(i.dailyDate).date();return t("button",{style:{backgroundColor:i.isFilled?$e:Ge},className:"h-32 w-32 flex flex-row items-center justify-center rounded-full text-white cursor-pointer",onClick:S=>{S.preventDefault(),G(i.dailyDate)},children:t("span",{children:g})},g)})}),t(Be,{tableLabel:f.t("TEAM_TABLE"),showId:!1,tableHeadings:lt(),hasActions:!1,t:f.t,tableRows:Y})]}):""}),t("div",{className:"flex flex-col w-full gap-12 px-12 pb-24",children:I?t(it,{bookingId:I,userShiftFlag:!0}):m(he,{children:[t(ie,{className:"font-bold",children:_.t("NOTES_DIALOG_BOX_TITLE")}),t(Ye,{control:xe,name:"notes",label:`${_.t("NOTES")}`,errors:Te,multiline:!0,rows:E<960?10:20,InputLabelProps:{shrink:!0},dialog:!0,calendarSpace:!0,placeholder:_.t("NOTES_PLACEHOLDER")})]})})]})})},ct=()=>{const n=ke(s=>s.user),E=A(ge),R=A(ne),u=ye(),[o,W]=a.useState(),H=a.useRef(null),U=()=>H.current.getApi(),[I,oe]=a.useState([{month:new Date().getMonth()+1,year:new Date().getFullYear(),businessId:"1"},{month:new Date().getMonth()+2,year:new Date().getFullYear(),businessId:"1"},{month:new Date().getMonth()+3,year:new Date().getFullYear(),businessId:"1"}]),$=se(I[0],{refetchOnMountOrArgChange:!0}),T=se(I[1],{refetchOnMountOrArgChange:!0}),G=se(I[2],{refetchOnMountOrArgChange:!0}),[c,K]=a.useState([]),[_,O]=a.useState([]),[f,X]=a.useState(!0),[N,l]=a.useState(!0),[w,J]=a.useState(!0),B=s=>{W(s)},Y=s=>{var r;const e=c.filter(d=>y(s.start).toISOString()===d.start)[0];e&&u(ae({children:t(ue,{day:y(s.start).format("yyyy-MM-DD"),businessId:"1",shiftId:n.data.shiftId.toString(),bookingId:(r=e.extendedProps.bookingId)==null?void 0:r.toString(),status:e.extendedProps.status,endDate:e.extendedProps.endDate,isDay:e.extendedProps.hasDayShift,isNight:e.extendedProps.hasNightShift,isHoliday:e.extendedProps.onHoliday})}))},z=s=>{var r;const e=c.filter(d=>y(s.event.start).toISOString()===d.start)[0];e&&u(ae({children:t(ue,{day:y(s.event.start).format("yyyy-MM-DD"),businessId:"1",shiftId:n.data.shiftId.toString(),bookingId:(r=e.extendedProps.bookingId)==null?void 0:r.toString(),status:e.extendedProps.status,endDate:e.extendedProps.endDate,isDay:e.extendedProps.hasDayShift,isNight:e.extendedProps.hasNightShift,isHoliday:e.extendedProps.onHoliday})}))},j=s=>{let e=s.start,r=s.end;return r.setSeconds(r.getSeconds()-1),e.getDate()===r.getDate()},L=s=>{s.map(e=>{let r=0;e.hasDayShift&&(r=0),e.hasNightShift&&(r=1),e.onHoliday&&(r=2),K(d=>d.filter(b=>b.id===e.id.toString()).length>0?d:[...d,{id:e.id.toString(),title:"",allDay:!0,start:y(e.day,"yyyy-MM-DD").toISOString(),end:y(e.day,"yyyy-MM-DD").add(1,"days").toISOString(),extendedProps:{label:ot[r],color:V[r],shiftPatternId:e.id.toString(),hasDayShift:e.hasDayShift,hasNightShift:e.hasNightShift,onHoliday:e.onHoliday,bookingId:e.bookingId,endDate:e.endDate,status:e.status}}])})};return a.useEffect(()=>{const{data:s,isLoading:e,isSuccess:r,isError:d,error:b,isFetching:x}=$;u(h(e)),u(h(x)),r&&s&&L(s),d&&b&&u(P(F(`${E.t("ERROR_LOADING_DATA")} ${R.t("USER_SHIFTS")}`,"error")))},[$]),a.useEffect(()=>{const{data:s,isLoading:e,isSuccess:r,isError:d,error:b,isFetching:x}=T;u(h(e)),u(h(x)),r&&s&&L(s),d&&b&&u(P(F(`${E.t("ERROR_LOADING_DATA")} ${R.t("USER_SHIFTS")}`,"error")))},[T]),a.useEffect(()=>{const{data:s,isLoading:e,isSuccess:r,isError:d,error:b,isFetching:x}=G;u(h(e)),u(h(x)),r&&s&&L(s),d&&b&&u(P(F(`${E.t("ERROR_LOADING_DATA")} ${R.t("USER_SHIFTS")}`,"error")))},[G]),a.useEffect(()=>{o!=null&&o.start&&oe([{month:o.start.getMonth()+1,year:o.start.getFullYear(),businessId:"1"},{month:o.start.getMonth()+2,year:o.start.getFullYear(),businessId:"1"},{month:o.start.getMonth()+3,year:o.start.getFullYear(),businessId:"1"}])},[o]),a.useEffect(()=>{if(c.length>0){let s=[];f&&N&&w?s=c:f&&N?s=c.filter(e=>e.extendedProps.hasDayShift===!0||e.extendedProps.hasNightShift===!0):f&&w?s=c.filter(e=>e.extendedProps.hasDayShift===!0||e.extendedProps.onHoliday===!0):w&&N?s=c.filter(e=>e.extendedProps.hasNightShift===!0||e.extendedProps.onHoliday===!0):(f&&(s=c.filter(e=>e.extendedProps.hasDayShift===!0)),N&&(s=c.filter(e=>e.extendedProps.hasNightShift===!0)),w&&(s=c.filter(e=>e.extendedProps.onHoliday===!0))),O(s)}},[c,f,N,w]),m("div",{className:"flex flex-col w-full",children:[m("div",{className:"flex flex-col md:flex-row space-between md:items-center w-full",children:[m("div",{className:"flex flex-row p-12 items-center mr-auto",children:[t(ie,{className:"text-2xl font-semibold tracking-tight whitespace-nowrap mx-16",children:o==null?void 0:o.view.title}),m("div",{className:"flex items-center",children:[t(ee,{title:"Previous",children:t(Z,{"aria-label":"Previous",onClick:()=>U().prev(),children:t(v,{size:20,children:"heroicons-solid:chevron-left"})})}),t(ee,{title:"Next",children:t(Z,{"aria-label":"Previous",onClick:()=>U().next(),children:t(v,{size:20,children:"heroicons-solid:chevron-right"})})}),t(ee,{title:"Today",children:t("div",{children:t(Pe.div,{initial:{scale:0},animate:{scale:1,transition:{delay:.3}},children:t(Z,{"aria-label":"today",onClick:()=>U().today(),size:"large",children:t(v,{children:"heroicons-outline:calendar"})})})})})]})]}),m("div",{className:"flex flex-col sm:flex-row md:items-center px-24 pb-24 md:p-12 md:px-0",children:[t(te,{label:m("div",{className:"flex flex-row items-center",children:[t("div",{className:"w-12 h-12 rounded-full mr-8",style:{backgroundColor:V[0]}}),"Day"]}),control:t(re,{checked:f,onChange:(s,e)=>X(e)})}),t(te,{label:m("div",{className:"flex flex-row items-center",children:[t("div",{className:"w-12 h-12 rounded-full mr-8",style:{backgroundColor:V[1]}}),"Night"]}),control:t(re,{checked:N,onChange:(s,e)=>l(e)})}),t(te,{label:m("div",{className:"flex flex-row items-center",children:[t("div",{className:"w-12 h-12 rounded-full mr-8",style:{backgroundColor:V[2]}}),"Holiday"]}),control:t(re,{checked:w,onChange:(s,e)=>J(e)})})]})]}),t(et,{plugins:[qe,Ze],headerToolbar:!1,initialView:"dayGridMonth",editable:!0,selectable:!0,dragScroll:!0,ref:H,initialDate:new Date,datesSet:B,selectLongPressDelay:100,eventLongPressDelay:1e5,selectAllow:j,select:Y,events:_.length>0?_:c,eventContent:s=>t(Fe,{sx:{backgroundColor:s.event.extendedProps.color},className:Re("flex items-center w-full rounded-4 py-12")}),eventClick:z})]})},ft=Le(je)(({theme:n})=>({...Xe(n),"&  .fc-media-screen":{minHeight:"70vh",maxHeight:"75vh",width:"100%"},"& .fc-scrollgrid, & .fc-theme-standard td, & .fc-theme-standard th":{borderColor:`${n.palette.divider}!important`,backgroundColor:Qe},"&  .fc-scrollgrid-section > td":{border:0},"& .fc-daygrid-day":{"&:last-child":{borderRight:0}},"& .fc-col-header-cell":{borderWidth:"0 1px 0 1px",padding:"8px 0 0 0","& .fc-col-header-cell-cushion":{color:n.palette.text.secondary,fontWeight:500,fontSize:12,textTransform:"uppercase"}},"& .fc-view ":{"& > .fc-scrollgrid":{border:0}},"& .fc-daygrid-day.fc-day-today":{backgroundColor:"transparent!important","& .fc-daygrid-day-number":{borderRadius:"100%",backgroundColor:`${n.palette.secondary.main}!important`,color:`${n.palette.secondary.contrastText}!important`}},"& .fc-daygrid-day-top":{justifyContent:"center","& .fc-daygrid-day-number":{color:n.palette.text.secondary,fontWeight:500,fontSize:12,display:"inline-flex",alignItems:"center",justifyContent:"center",width:26,height:26,margin:"4px 0",borderRadius:"50%",float:"none",lineHeight:1}},"& .fc-h-event":{background:"initial"},"& .fc-event":{border:0,padding:"0 ",fontSize:12,margin:"0 6px 4px 6px!important"},"& .fc-highlight":{background:Ve}})),xt=()=>{const{t:n}=A(ne);return t(ft,{header:t(Je,{title:n("TITLE")}),scroll:"page",content:t(ct,{})})};export{xt as default};
//# sourceMappingURL=UserShifts-B9iIfdiq.js.map

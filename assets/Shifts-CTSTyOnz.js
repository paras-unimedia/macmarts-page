import{J as K,C as oe,K as Pe,x as ne,r as l,M as fe,y as Ae,z as b,A as H,N as ce,d as T,j as t,O as Se,Q as re,o as Oe,F as le,w as ve,T as $e,R as Ee,U as ge,v as ke,V as Ge,W as we,X as Me,Y as Ue,E as Ce,m as Be,Z as Ye,s as Ve,_ as ze}from"./index-Db1G4GFK.js";import{u as P,z as g,t as Ne,s as I,h as te,D as qe,P as je}from"./SnackbarDefaults-bH2yLHx5.js";import{S as se,u as Re,C as q,a as Qe,b as be,c as We,d as Xe,e as Ze,M as Je,f as Ke,F as et,B as tt,g as st}from"./CustomFormDialog-CJNVvg9u.js";import{u as Fe,C as Le,a as rt,b as He}from"./BusinessPhasesApi-IBxa8BZM.js";import{C as Z,a as nt,b as it}from"./CustomSelectField-BK9WybEE.js";import{S as J,a as de}from"./SelectListShifts-CS2NmeDY.js";import{u as ot,a as at,b as lt,c as ct,d as ut}from"./ShiftsApi-CqFIuQVz.js";import{E as ht}from"./FormErrors-CNJI8p9W.js";import{i as dt,a as ft,F as St}from"./index-DDiROGzA.js";import"./ListSubheader-CyAfKHC_.js";import"./InputAdornment-B4lIQZ4Z.js";(function(){try{var c=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new Error().stack;s&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[s]="3b65ae23-5408-4987-bde5-b204aa87c9bc",c._sentryDebugIdIdentifier="sentry-dbid-3b65ae23-5408-4987-bde5-b204aa87c9bc")}catch{}})();const mt=()=>[{key:"",label:"SHIFTS"},{key:"shift-pattern",label:"SHIFT_PATTERN"}],pt=()=>[{key:"businessPhaseName",title:"PHASE",isConstantTranslation:!0,canBeSorted:!0,customSortVar:"phase"},{key:"metl",title:"METL",isConstantTranslation:!0},{key:"name",title:"NAME",isConstantTranslation:!0,canBeSorted:!0},{key:"day",title:"DAY",isConstantTranslation:!0},{key:"night",title:"NIGHT",isConstantTranslation:!0},{key:"slots",title:"SLOTS",canBeSorted:!0},{key:"minHeadCountDay",title:"MIN_CD",tooltipMessage:"MIN_DAY_HEAD_COUNT",canBeSorted:!0},{key:"minHeadCountNight",title:"MIN_CN",tooltipMessage:"MIN_NIGHT_HEAD_COUNT",canBeSorted:!0},{key:"usersCount",title:"USERS",isConstantTranslation:!0},{key:"ptl",title:"PTL",isConstantTranslation:!0},{key:"shiftPatternType",title:"SHIFT_PT",tooltipMessage:"SHIFT_PATTERN",canBeSorted:!0,customSortVar:"shiftPattern"}],ye=c=>{const{add:s,shiftsId:i}=c,n=P(K),a=P(oe),d=P(Pe),h=ne(),[D,m]=l.useState({businessId:1,pageSize:fe,sortBy:"name",sortOrder:se.ASCENDING,page:1}),[y,A]=l.useState(!0),[_,k]=l.useState([]),[F,U]=l.useState(0),G=Re("1",{refetchOnMountOrArgChange:!0}),B=Fe(D),Y=ot(i,{refetchOnMountOrArgChange:!0,skip:y}),[j,V]=l.useState(),[Q,W]=at(),[e,o]=lt();l.useEffect(()=>(i&&A(!1),()=>A(!0)),[i]);const u={id:void 0,businessId:1,businessPhaseId:s?void 0:null,name:"",dayShiftStartHour:7,dayShiftEndHour:19,nightShiftStartHour:19,nightShiftEndHour:7,slots:0,minHeadCountDay:0,minHeadCountNight:0,shiftPatternType:0},C=g.object({id:g.number().optional(),businessId:g.number().optional(),businessPhaseId:g.any(),name:g.string().min(1,`${n.t("SHIFT")} ${a.t(ht)}`),dayShiftStartHour:g.number(),dayShiftEndHour:g.number(),nightShiftStartHour:g.number(),nightShiftEndHour:g.number(),slots:g.number().min(1),minHeadCountDay:g.number().min(1),minHeadCountNight:g.number().min(1),shiftPatternType:g.number().min(1)}),z=Ae({mode:"onChange",defaultValues:u,resolver:Ne(C)}),{handleSubmit:w,control:r,formState:E,setValue:S,reset:N,setError:M,clearErrors:X,watch:x}=z,{isValid:ee,errors:R,isDirty:ae}=E;l.useEffect(()=>{const{isSuccess:f,data:p,isLoading:O,isFetching:v,isError:$,error:L}=B;if(h(b(O)),h(b(v)),f&&p){const{data:he,totalCount:xe}=p;he.map(ie=>{_.filter(Te=>Te.value==ie.id).length===0&&k(Te=>[...Te,{label:ie.name,value:ie.id,totalHeadCount:ie.minHeadCount}])}),U(ie=>D.filter?ie:xe)}$&&L&&h(H(I(`${a.t("ERROR_LOADING_DATA")} ${d.t("BUSINESS_PHASES")}`,"error")))},[B]),l.useEffect(()=>{const{isSuccess:f,data:p,isLoading:O,isFetching:v,isError:$,error:L}=G;h(b(O)),h(b(v)),f&&p&&(p.slotsShift&&S("slots",p.slotsShift),p.dayShiftStartHour&&S("dayShiftStartHour",p.dayShiftStartHour),p.dayShiftEndHour&&S("dayShiftEndHour",p.dayShiftEndHour),p.nightShiftStartHour&&S("nightShiftStartHour",p.nightShiftStartHour),p.nightShiftEndHour&&S("nightShiftEndHour",p.nightShiftEndHour)),$&&L&&h(H(I(`${a.t("ERROR_LOADING_DATA")} ${d.t("BUSINESS_INFO")}`,"error")))},[G]),l.useEffect(()=>{const{data:f,isSuccess:p,isLoading:O,isError:v,error:$}=Y;return h(b(O)),p&&f&&(Object.keys(f).forEach(L=>S(L,f[L])),S("businessPhaseId",_.filter(L=>L.value===f.businessPhaseId)[0])),v&&$&&h(H(I(`${a.t("ERROR_LOADING_DATA")} ${d.t("USER_CATEGORY")}`,"error"))),()=>Object.keys(u).forEach(L=>S(L,u[L]))},[Y]),l.useEffect(()=>{s&&V(_.filter(f=>f.value===1)[0])},[_]);const ue=f=>{s?Q(f):e(f),N(f)};l.useEffect(()=>{const{isError:f,isLoading:p,isSuccess:O,data:v,error:$}=W;h(b(p)),O&&v&&(setTimeout(()=>{h(H(I(`${n.t("SHIFT")} ${a.t("ADD_SUCCESSFUL")}`,"success")))},250),h(ce())),f&&$&&h(H(I(`${a.t("ADD_ERROR")} ${n.t("SHIFT")}`,"error")))},[W]),l.useEffect(()=>{const{isError:f,isLoading:p,isSuccess:O,data:v,error:$}=o;h(b(p)),O&&v&&(setTimeout(()=>{h(H(I(`${n.t("SHIFT")} ${a.t("SAVE_SUCCESSFUL")}`,"success")))},250),h(ce())),f&&$&&h(H(I(`${a.t("SAVE_ERROR")} ${n.t("SHIFT")}`,"error")))},[o]);const me=()=>{_.length<F&&m(f=>({...f,page:f.page+1,filter:void 0}))},pe=f=>{f&&setTimeout(()=>m(p=>({...p,filter:f})),500)};return T(Qe,{isGrid:!0,isDirty:ae,isValid:ee,actions:[{title:s?a.t("ADD"):a.t("SAVE"),onClick:w(f=>ue({...f,businessPhaseId:f.businessPhaseId.value}))}],handleSubmit:w(f=>ue({...f,businessPhaseId:f.businessPhaseId.value})),title:s?`${a.t("ADD")} ${n.t("SHIFT")}`:`${a.t("EDIT")} ${n.t("SHIFT")}`,children:[t(Le,{control:r,name:"businessPhaseId",label:a.t("PHASE"),errors:R,required:!0,InputLabelProps:{shrink:!0},dialog:"true",col2:"true",selectList:_,onScrollFunc:me,onInputChange:pe,onSelectState:V}),t(q,{control:r,name:"name",label:a.t("NAME"),errors:R,required:!0,InputLabelProps:{shrink:!0},col2:"true",dialog:"true",placeholder:a.t("NAME")}),t(q,{control:r,name:"slots",label:d.t("SLOTS"),errors:R,required:!0,InputLabelProps:{shrink:!0},col1:"true",dialog:"true",type:"number",placeholder:d.t("SLOTS")}),t(q,{control:r,name:"minHeadCountDay",label:n.t("DAY_HEAD_COUNT"),errors:R,required:!0,InputLabelProps:{shrink:!0},col1:"true",dialog:"true",type:"number",placeholder:n.t("DAY_HEAD_COUNT")}),t(q,{control:r,name:"minHeadCountNight",label:n.t("NIGHT_HEAD_COUNT"),errors:R,required:!0,InputLabelProps:{shrink:!0},col1:"true",dialog:"true",type:"number",placeholder:n.t("NIGHT_HEAD_COUNT")}),t(q,{control:r,name:"shiftPatternType",label:n.t("SHIFT_PATTERN"),errors:R,required:!0,InputLabelProps:{shrink:!0},col1:"true",dialog:"true",type:"number",placeholder:n.t("SHIFT_PATTERN")}),T("div",{className:"flex flex-col mr-32 col-span-4 md:col-span-2",children:[T("div",{className:"flex flex-row items-center",children:[t(Z,{control:r,name:"dayShiftStartHour",label:d.t("DAY_SHIFT_START_HOUR"),errors:R,selectList:J,type:"number",double:"true",InputLabelProps:{shrink:!0},placeholder:d.t("DAY_SHIFT_START_HOUR")})," ",t("span",{className:"mx-12 mt-4",children:"-"}),t(Z,{control:r,name:"dayShiftEndHour",label:d.t("DAY_SHIFT_END_HOUR"),errors:R,selectList:J,type:"number",double:"true",InputLabelProps:{shrink:!0},placeholder:d.t("DAY_SHIFT_END_HOUR")})]}),t(Se,{children:" "})]}),T("div",{className:"flex flex-col mr-32 col-span-4 md:col-span-2",children:[T("div",{className:"flex flex-row items-center",children:[t(Z,{control:r,name:"nightShiftStartHour",label:d.t("NIGHT_SHIFT_START_HOUR"),errors:R,selectList:J,type:"number",double:"true",InputLabelProps:{shrink:!0},placeholder:d.t("NIGHT_SHIFT_START_HOUR")})," ",t("span",{className:"mx-12 mt-4",children:"-"}),t(Z,{control:r,name:"nightShiftEndHour",label:d.t("NIGHT_SHIFT_END_HOUR"),errors:R,selectList:J,type:"number",double:"true",InputLabelProps:{shrink:!0},placeholder:d.t("NIGHT_SHIFT_END_HOUR")})]}),t(Se,{children:" "})]})]})},Ie=c=>{const{isDialog:s,handleSubmit:i,control:n,errors:a,setValue:d}=c,h=P(oe),D=P(K),m=P(Pe),y=ne(),[A,_]=l.useState({businessId:1,pageSize:fe,sortBy:"name",sortOrder:se.ASCENDING,page:1}),[k,F]=l.useState([]),[U,G]=l.useState(0),[B,Y]=l.useState(),j=Re("1",{refetchOnMountOrArgChange:!0}),V=Fe(A);l.useEffect(()=>{const{isSuccess:o,data:u,isLoading:C,isFetching:z,isError:w,error:r}=V;if(y(b(C)),y(b(z)),o&&u){const{data:E,totalCount:S}=u;E.map(N=>{k.filter(M=>M.value==N.id).length===0&&F(M=>[...M,{label:N.name,value:N.id,totalHeadCount:N.minHeadCount}])}),G(N=>A.filter?N:S)}w&&r&&y(H(I(`${h.t("ERROR_LOADING_DATA")} ${m.t("BUSINESS_PHASES")}`,"error")))},[V]),l.useEffect(()=>{const{isSuccess:o,data:u,isLoading:C,isFetching:z,isError:w,error:r}=j;y(b(C)),y(b(z)),o&&u&&(u.slotsShift&&d("slots",u.slotsShift),u.dayShiftStartHour&&d("dayShiftStartHour",u.dayShiftStartHour),u.dayShiftEndHour&&d("dayShiftEndHour",u.dayShiftEndHour),u.nightShiftStartHour&&d("nightShiftStartHour",u.nightShiftStartHour),u.nightShiftEndHour&&d("nightShiftEndHour",u.nightShiftEndHour)),w&&r&&y(H(I(`${h.t("ERROR_LOADING_DATA")} ${m.t("BUSINESS_INFO")}`,"error")))},[j]);const Q=()=>{k.length<U&&_(o=>({...o,page:o.page+1,filter:void 0}))},W=o=>{o&&setTimeout(()=>_(u=>({...u,filter:o})),500)},e=o=>T(Oe,{children:[t(Le,{control:n,name:"businessPhaseId",label:h.t("PHASE"),errors:a,filter:o.filter,dialog:o.dialog,col2:o.isGrid,InputLabelProps:{shrink:!0},selectList:k,onScrollFunc:Q,onInputChange:W,onSelectState:Y}),t(q,{control:n,name:"name",label:h.t("NAME"),errors:a,InputLabelProps:{shrink:!0},filter:o.filter,dialog:o.dialog,col2:o.isGrid,placeholder:h.t("NAME")}),t(q,{control:n,name:"slots",label:m.t("SLOTS"),errors:a,InputLabelProps:{shrink:!0},type:"number",col1:o.isGrid,filter:o.filter,dialog:o.dialog,placeholder:m.t("SLOTS")}),t(q,{control:n,name:"minHeadCountDay",label:D.t("HEAD_COUNT"),errors:a,InputLabelProps:{shrink:!0},type:"number",col1:o.isGrid,filter:o.filter,dialog:o.dialog,placeholder:D.t("HEAD_COUNT")}),t(q,{control:n,name:"shiftPatternType",label:D.t("SHIFT_PATTERN"),errors:a,InputLabelProps:{shrink:!0},type:"number",col1:o.isGrid,filter:o.filter,dialog:o.dialog,placeholder:D.t("SHIFT_PATTERN")}),T("div",{className:"flex flex-col mr-32 col-span-4 md:col-span-2",children:[T("div",{className:"flex flex-row items-center",children:[t(Z,{control:n,name:"dayShiftStartHour",label:m.t("DAY_SHIFT_START_HOUR"),errors:a,selectList:J,type:"number",double:"true",InputLabelProps:{shrink:!0},placeholder:m.t("DAY_SHIFT_START_HOUR")})," ",t("span",{className:"mx-12 mt-4",children:"-"}),t(Z,{control:n,name:"dayShiftEndHour",label:m.t("DAY_SHIFT_END_HOUR"),errors:a,selectList:J,type:"number",double:"true",InputLabelProps:{shrink:!0},placeholder:m.t("DAY_SHIFT_END_HOUR")})]}),t(Se,{children:" "})]}),T("div",{className:"flex flex-col mr-32 col-span-4 md:col-span-2",children:[T("div",{className:"flex flex-row items-center",children:[t(Z,{control:n,name:"nightShiftStartHour",label:m.t("NIGHT_SHIFT_START_HOUR"),errors:a,selectList:J,type:"number",double:"true",InputLabelProps:{shrink:!0},placeholder:m.t("NIGHT_SHIFT_START_HOUR")})," ",t("span",{className:"mx-12 mt-4",children:"-"}),t(Z,{control:n,name:"nightShiftEndHour",label:m.t("NIGHT_SHIFT_END_HOUR"),errors:a,selectList:J,type:"number",double:"true",InputLabelProps:{shrink:!0},placeholder:m.t("NIGHT_SHIFT_END_HOUR")})]}),t(Se,{children:" "})]})]});return s?t(be,{title:h.t("FILTER")+" "+D.t("SHIFTS"),actions:[{title:h.t("FILTER"),onClick:i}],children:t("div",{className:"grid md:grid-cols-4 gap-12 ",children:e({filter:!1,dialog:!0,isGrid:!0})})}):t(nt,{hasAddButton:!0,handleFilterClick:i,handleAddClick:()=>y(re({children:t(ye,{add:!0})})),children:e({filter:!0,dialog:!1})})},Tt=c=>{const s=P(oe),i=P(K),{shiftsId:n}=c,a=ne(),[d,h]=ct();return l.useEffect(()=>{const{isSuccess:D,isError:m,error:y,isLoading:A}=h;a(b(A)),D&&(setTimeout(()=>{a(H(I(`${i.t("SHIFT")} ${s.t("DELETE_SUCCESSFUL")}`,"success")))},250),a(ce())),y&&m&&a(H(I(`${s.t("DELETE_ERROR")} ${i.t("SHIFT")}`,"error")))},[h]),t(be,{title:`${s.t("DELETE")} ${i.t("SHIFT")}`,actions:[{title:s.t("DELETE"),onClick:()=>{d(n)}}],children:T("div",{className:"flex flex-col px-12",children:[T("p",{className:"mb-10",children:[s.t("DELETE_MSG_1")," ",i.t("SHIFT"),"?"]}),T("p",{className:"mb-32",children:[s.t("DELETE_PREFIX")," ",i.t("SHIFT")," ",s.t("DELETE_MSG_2")]})]})})},Et=(c,s)=>[{label:"EDIT",icon:t(le,{className:"pointer-events-none",size:24,children:"material-outline:edit"}),iconColor:"success",onClick:c},{label:"DELETE",icon:t(le,{className:"pointer-events-none",size:24,children:"material-outline:delete"}),iconColor:"error",onClick:s}],gt=()=>{const c=P(oe),s=P(K),i=ne(),[n,a]=l.useState({businessId:1,page:1,pageSize:fe,sortBy:"phase",sortOrder:se.ASCENDING}),[d,h]=l.useState({currentPage:1,pageSize:fe,totalCount:0,totalPages:0}),[D,m]=l.useState([]),y=ut(n,{refetchOnMountOrArgChange:!0}),A={businessPhaseId:void 0,name:"",dayShiftStartHour:7,dayShiftEndHour:19,nightShiftStartHour:7,nightShiftEndHour:19,slots:0,minHeadCountDay:0,shiftPatternType:0},_=g.object({businessPhaseId:g.any().optional(),name:g.string().optional(),dayShiftStartHour:g.number().optional(),dayShiftEndHour:g.number().optional(),nightShiftStartHour:g.number().optional(),nightShiftEndHour:g.number().optional(),slots:g.number().optional(),minHeadCountDay:g.number().optional(),shiftPatternType:g.number().optional()}),k=Ae({mode:"onChange",defaultValues:A,resolver:Ne(_)}),{handleSubmit:F,control:U,formState:G,setValue:B}=k,{errors:Y}=G,j=e=>{const{id:o}=e.target;i(re({children:t(ye,{add:!1,shiftsId:o})}))},V=e=>{const{id:o}=e.target;i(re({children:t(Tt,{shiftsId:o})}))};l.useEffect(()=>{const{data:e,isLoading:o,isSuccess:u,isError:C,error:z,isFetching:w}=y;if(i(b(o)),i(b(w)),u&&e){const{totalCount:r,totalPages:E,currentPage:S,data:N,pageSize:M}=e;h(X=>({...X,totalCount:r,totalPages:E,currentPage:S,pageSize:M})),N.map(X=>{const{id:x,businessPhaseName:ee,name:R,slots:ae,shiftPatternType:ue,usersCount:me,dayShiftStartHour:pe,dayShiftEndHour:f,nightShiftStartHour:p,nightShiftEndHour:O,minHeadCountDay:v,minHeadCountNight:$}=X;m(L=>{const he=L;return he.push({id:x,actions:!0,businessPhaseName:ee,name:R,slots:ae,day:`${de[pe].label} - ${de[f].label}`,night:`${de[p].label} - ${de[O].label}`,shiftPatternType:ue,usersCount:me,minHeadCountDay:v,minHeadCountNight:$}),he})})}return C&&z&&i(H(I(`${c.t("ERROR_LOADING_DATA")} ${s.t("SHIFTS")}`,"error"))),()=>m([])},[y]);const Q=(e,o)=>{a(u=>({...u,page:o+1}))},W=(e,o)=>{a(u=>{let C;return u.sortBy===o?u.sortOrder===se.ASCENDING?C=se.DESCENDING:C=se.ASCENDING:C=se.ASCENDING,{...u,sortBy:o,sortOrder:C}})};return T(it,{title:s.t("SHIFTS"),hasFilterButton:!0,hasAddButton:!0,handleClick:()=>i(re({children:t(ye,{add:!0})})),handleFilterClick:()=>i(re({children:t(Ie,{isDialog:!0,control:U,handleSubmit:F(e=>{a(o=>{var u;return{...o,businessPhaseId:(u=e==null?void 0:e.businessPhaseId)==null?void 0:u.value,name:e==null?void 0:e.name,dayShiftStartHour:e==null?void 0:e.dayShiftStartHour,dayShiftEndHour:e==null?void 0:e.dayShiftEndHour,nightShiftStartHour:e==null?void 0:e.nightShiftStartHour,nightShiftEndHour:e==null?void 0:e.nightShiftEndHour,slots:e==null?void 0:e.slots,minHeadCountDay:e==null?void 0:e.minHeadCountDay,shiftPatternType:e==null?void 0:e.shiftPatternType}}),i(ce())}),setValue:B,errors:Y})})),children:[t(Ie,{control:U,handleSubmit:F(e=>{a(o=>{var u;return{...o,businessPhaseId:(u=e==null?void 0:e.businessPhaseId)==null?void 0:u.value,name:e==null?void 0:e.name,dayShiftStartHour:e==null?void 0:e.dayShiftStartHour,dayShiftEndHour:e==null?void 0:e.dayShiftEndHour,nightShiftStartHour:e==null?void 0:e.nightShiftStartHour,nightShiftEndHour:e==null?void 0:e.nightShiftEndHour,slots:e==null?void 0:e.slots,minHeadCountDay:e==null?void 0:e.minHeadCountDay,shiftPatternType:e==null?void 0:e.shiftPatternType}})}),setValue:B,errors:Y}),t(We,{sortBy:n==null?void 0:n.sortBy,sortOrder:n==null?void 0:n.sortOrder,hasActions:!0,showId:!1,tableLabel:s.t("SHIFTS"),tableHeadings:pt(),t:s.t,tableInfo:d,tableRows:D,handlePageChange:Q,handleSortChange:W,hasFilterButton:!0,manyFilters:!0,tableActions:Et(j,V)})]})},yt=["shiftPatterns/fetchAll","shiftTypes/fetchAll"],bt=ve.enhanceEndpoints({addTagTypes:yt}).injectEndpoints({endpoints:c=>({getAllShiftTypes:c.query({query:()=>({url:"/shifts/getshifttypes"}),providesTags:["shiftTypes/fetchAll"]}),getAllShiftPatterns:c.query({query:({businessId:s,year:i,month:n})=>n?{url:`/shifts/getshiftpatternmonthwise?month=${n}&year=${i}&businessId=${s}`}:{url:`/shifts/getshiftpatternyearwise?year=${i}&businessId=${s}`},providesTags:["shiftPatterns/fetchAll"]}),postShiftPattern:c.mutation({query:s=>({url:"/shifts/addshiftpattern",method:"POST",data:s}),invalidatesTags:["shiftPatterns/fetchAll"]}),deleteShiftPattern:c.mutation({query:s=>({url:`/shifts/deleteshiftpatterns/${s}`,method:"DELETE"}),invalidatesTags:["shiftPatterns/fetchAll"]})})}),{useGetAllShiftTypesQuery:Ht,useGetAllShiftPatternsQuery:It,usePostShiftPatternMutation:Dt,useDeleteShiftPatternMutation:_t}=bt,De=[Xe,Ze,Je,Ke],_e=c=>{const s=P(oe),i=P(K),{shiftPatternId:n,date:a}=c,d=ne(),[h,D]=_t();return l.useEffect(()=>{const{isSuccess:m,isError:y,error:A,isLoading:_}=D;d(b(_)),m&&(setTimeout(()=>{d(H(I(`${i.t("SHIFT_PATTERN")} ${s.t("DELETE_SUCCESSFUL")}`,"success")))},250),d(ce())),A&&y&&d(H(I(`${s.t("DELETE_ERROR")} ${i.t("SHIFT_PATTERN")}`,"error")))},[D]),t(be,{title:`${s.t("DELETE")} ${i.t("SHIFT_PATTERN")}`,actions:[{title:s.t("DELETE"),onClick:()=>{h(n)}}],children:T("div",{className:"flex flex-col px-12",children:[T("p",{className:"mb-10",children:[s.t("DELETE_MSG_1")," ",i.t("SHIFT_PATTERN")," ",a,"?"]}),T("p",{className:"mb-32",children:[s.t("DELETE_PREFIX")," ",i.t("SHIFT_PATTERN")," ",s.t("DELETE_MSG_2")]})]})})},Pt=()=>{const c=P(oe),s=P(K),i=ne(),[n,a]=l.useState(),d=l.useRef(null),h=()=>d.current.getApi(),[D,m]=l.useState({businessId:1,year:new Date().getFullYear()}),y=It(D,{refetchOnMountOrArgChange:!0}),[A,_]=l.useState([]),k=Ht(),[F,U]=l.useState([]),[G,B]=l.useState(0),[Y,j]=Dt(),[V,Q]=l.useState(!1),[W,e]=l.useState(""),o=r=>{B(parseInt(r.target.value))},u=r=>{a(r);const E=r.start.getFullYear();E!==new Date().getFullYear()&&m(S=>({...S,year:E}))},C=r=>{if(!V){e(te(r.start).format("yyyy-MM-DD"));const E=A.filter(({start:S})=>te(r.start).toISOString()===S)[0];E?i(re({children:t(_e,{shiftPatternId:E.id,date:te(E.start).format("yyyy-MM-DD")})})):Y({day:te(r.start).format("yyyy-MM-DD"),businessId:1,shiftTypeId:G})}},z=r=>{r.jsEvent.preventDefault();const E=r.event.extendedProps.shiftPatternId;i(re({children:t(_e,{shiftPatternId:E,date:te(r.event.start).format("yyyy-MM-DD")})}))},w=r=>{let E=r.start,S=r.end;return S.setSeconds(S.getSeconds()-1),E.getDate()===S.getDate()};return l.useEffect(()=>{const{data:r,isLoading:E,isSuccess:S,isError:N,error:M,isFetching:X}=y;return Q(E),i(b(E)),i(b(X)),S&&r&&r.map(x=>{_(ee=>[...ee,{id:x.id.toString(),title:"",allDay:!0,start:te(x.day,"yyyy-MM-DD").toISOString(),end:te(x.day,"yyyy-MM-DD").add("days",1).toISOString(),extendedProps:{label:F[x.shiftTypeId-1],color:De[x.shiftTypeId-1],shiftPatternId:x.id.toString()}}])}),N&&M&&i(H(I(`${c.t("ERROR_LOADING_DATA")} ${s.t("SHIFT_PATTERNS")}`,"error"))),()=>_([])},[y]),l.useEffect(()=>{const{data:r,isLoading:E,isSuccess:S,isError:N,error:M}=k;return i(b(E)),S&&r&&r.map((X,x)=>{const{id:ee,name:R}=X;U(ae=>[...ae,{id:ee,name:R,color:De[x]}])}),N&&M&&i(H(I(`${c.t("ERROR_LOADING_DATA")} ${s.t("SHIFT_PATTERN_TYPES")}`,"error"))),()=>U([])},[k]),l.useEffect(()=>{const{isSuccess:r,isError:E,isLoading:S}=j;Q(S),r&&i(H(I(`${s.t("SHIFT_PATTERN_TYPE")}: ${F[G-1].name}
Date: ${W}
${c.t("ADD_SUCCESSFUL")}`,"success"))),E&&i(H(I(`${c.t("ADD_ERROR")} ${s.t("SHIFT_PATTERN")}`,"error")))},[j]),l.useEffect(()=>{F.length>0&&B(F[0].id)},[F]),T("div",{className:"flex flex-col w-full",children:[T("div",{className:"flex flex-col md:flex-row w-full",children:[T("div",{className:"flex flex-row p-12 items-center",children:[t($e,{className:"text-2xl font-semibold tracking-tight whitespace-nowrap mx-16",children:n==null?void 0:n.view.title}),T("div",{className:"flex items-center",children:[t(ge,{title:"Previous",children:t(Ee,{"aria-label":"Previous",onClick:()=>h().prev(),children:t(le,{size:20,children:"heroicons-solid:chevron-left"})})}),t(ge,{title:"Next",children:t(Ee,{"aria-label":"Previous",onClick:()=>h().next(),children:t(le,{size:20,children:"heroicons-solid:chevron-right"})})}),t(ge,{title:"Today",children:t("div",{children:t(ke.div,{initial:{scale:0},animate:{scale:1,transition:{delay:.3}},children:t(Ee,{"aria-label":"today",onClick:()=>h().today(),size:"large",children:t(le,{children:"heroicons-outline:calendar"})})})})})]})]}),T("div",{className:"flex flex-col md:flex-row md:items-center px-24 pb-24 md:p-12 md:px-0",children:[t("span",{className:"mr-48",children:"Day / Night: "}),t(Ue,{children:t(Ge,{row:!0,"aria-labelledby":`${s.t("SHIFT_PATTERN_TYPES")}`,name:"shiftTypeValue",value:G,onChange:o,children:F.map(r=>t(we,{value:r.id,label:T("span",{className:"mr-12 flex flex-row items-center",children:[t("div",{className:"w-12 h-12 rounded-full mr-8",style:{backgroundColor:r.color}}),r.name]}),control:t(Me,{})},r.id))})})]})]}),t(St,{plugins:[dt,ft],headerToolbar:!1,initialView:"dayGridMonth",editable:!0,selectable:!0,dragScroll:!0,ref:d,initialDate:new Date,datesSet:u,selectLongPressDelay:100,eventLongPressDelay:1e5,selectAllow:w,select:C,events:A,eventContent:r=>t(Ce,{sx:{backgroundColor:r.event.extendedProps.color},className:Be("flex items-center w-full rounded-4 py-12")}),eventClick:z})]})},At=c=>{const{selectedTab:s}=Ye(n=>n.shifts),{t:i}=P(K);return T(Ce,{sx:{width:"100%"},children:[t(rt,{tabValue:s,tabLabel:"shifts",tabs:mt(),t:i}),t(He,{value:s,index:0,aria:"Shifts",children:t(gt,{})}),t(He,{value:s,index:1,aria:"ShiftPattern",children:t(Pt,{})})]})},Ct=Ve(et)(({theme:c})=>({...qe(c),"&  .fc-media-screen":{minHeight:"60vh",maxHeight:"70vh",width:"100%"},"& .fc-scrollgrid, & .fc-theme-standard td, & .fc-theme-standard th":{borderColor:`${c.palette.divider}!important`,backgroundColor:tt},"&  .fc-scrollgrid-section > td":{border:0},"& .fc-daygrid-day":{"&:last-child":{borderRight:0}},"& .fc-col-header-cell":{borderWidth:"0 1px 0 1px",padding:"8px 0 0 0","& .fc-col-header-cell-cushion":{color:c.palette.text.secondary,fontWeight:500,fontSize:12,textTransform:"uppercase"}},"& .fc-view ":{"& > .fc-scrollgrid":{border:0}},"& .fc-daygrid-day.fc-day-today":{backgroundColor:"transparent!important","& .fc-daygrid-day-number":{borderRadius:"100%",backgroundColor:`${c.palette.secondary.main}!important`,color:`${c.palette.secondary.contrastText}!important`}},"& .fc-daygrid-day-top":{justifyContent:"center","& .fc-daygrid-day-number":{color:c.palette.text.secondary,fontWeight:500,fontSize:12,display:"inline-flex",alignItems:"center",justifyContent:"center",width:26,height:26,margin:"4px 0",borderRadius:"50%",float:"none",lineHeight:1}},"& .fc-h-event":{background:"initial"},"& .fc-event":{border:0,padding:"0 ",fontSize:12,margin:"0 6px 4px 6px!important"},"& .fc-highlight":{background:st}})),Mt=c=>{const{tab:s}=c,{t:i}=P(K),n=ne();return l.useEffect(()=>{const a=d=>{n(ze({tab:d}))};return s>=0&&a(s),()=>{a(0)}},[s]),t(Ct,{header:t(je,{title:i("TITLE")}),scroll:"page",content:t(At,{})})};export{Mt as default};
//# sourceMappingURL=Shifts-CTSTyOnz.js.map

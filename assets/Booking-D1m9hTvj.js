import{s as bt,a2 as Rt,a3 as Y,a4 as It,a5 as Pt,m as _t,r as u,a6 as t,a as Gt,C as St,a7 as it,K as $t,a8 as Ut,x as kt,z as O,A as U,y as Bt,N as rt,j as n,d as F,a9 as Vt,aa as tt,T as Tt,Q as nt,o as Yt,F as jt,M as Et}from"./index-Db1G4GFK.js";import{h as k,u as N,s as V,z as C,t as Mt,D as Kt,P as Wt}from"./SnackbarDefaults-bH2yLHx5.js";import{P as zt,D as Ht,u as Qt,a as qt,r as pt,s as Xt,v as Zt,b as xt,C as Jt}from"./CustomDatePickerField-CncB9y7f.js";import{V as te,h as wt,O as ee,u as se,C as ae,a as oe,b as re,S as J,c as ne,F as ie}from"./CustomFormDialog-CJNVvg9u.js";import{a as le,C as At,b as ce}from"./CustomSelectField-BK9WybEE.js";import{B as ue,u as de,a as Dt,b as he,c as fe,d as ye,e as ge}from"./BookingInformationDialog-DxV8TDpZ.js";import"./InputAdornment-B4lIQZ4Z.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},r=new Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="c5bab3c6-7d96-4fb2-96df-bd105a356172",e._sentryDebugIdIdentifier="sentry-dbid-c5bab3c6-7d96-4fb2-96df-bd105a356172")}catch{}})();const me=["props","ref"],pe=bt(zt)(({theme:e})=>({overflow:"hidden",minWidth:Ht,backgroundColor:(e.vars||e).palette.background.paper})),De=e=>{var r;let{props:i,ref:y}=e,g=Rt(e,me);const{localeText:a,slots:o,slotProps:l,className:S,sx:c,displayStaticWrapperAs:h,autoFocus:m}=i,{layoutProps:j,renderCurrentView:A}=Qt(Y({},g,{props:i,autoFocusView:m??!1,additionalViewProps:{},wrapperVariant:h})),K=(r=o==null?void 0:o.layout)!=null?r:pe;return{renderPicker:()=>{var v,R,P;return It.jsx(Pt,{localeText:a,children:It.jsx(K,Y({},j,l==null?void 0:l.layout,{slots:o,slotProps:l,sx:[...Array.isArray(c)?c:[c],...Array.isArray(l==null||(v=l.layout)==null?void 0:v.sx)?l.layout.sx:[l==null||(R=l.layout)==null?void 0:R.sx]],className:_t(S,l==null||(P=l.layout)==null?void 0:P.className),ref:y,children:A()}))})}}},Ft=u.forwardRef(function(r,i){var y,g,a;const o=qt(r,"MuiStaticDatePicker"),l=(y=o.displayStaticWrapperAs)!=null?y:"mobile",S=Y({day:pt,month:pt,year:pt},o.viewRenderers),c=Y({},o,{viewRenderers:S,displayStaticWrapperAs:l,yearsPerRow:(g=o.yearsPerRow)!=null?g:l==="mobile"?3:4,slotProps:Y({},o.slotProps,{toolbar:Y({hidden:l==="desktop"},(a=o.slotProps)==null?void 0:a.toolbar)})}),{renderPicker:h}=De({props:c,valueManager:Xt,valueType:"date",validator:Zt,ref:i});return h()});Ft.propTypes={autoFocus:t.bool,className:t.string,components:t.object,componentsProps:t.object,dayOfWeekFormatter:t.func,defaultCalendarMonth:t.any,defaultValue:t.any,disabled:t.bool,disableFuture:t.bool,disableHighlightToday:t.bool,disablePast:t.bool,displayStaticWrapperAs:t.oneOf(["desktop","mobile"]),displayWeekNumber:t.bool,fixedWeekNumber:t.number,loading:t.bool,localeText:t.object,maxDate:t.any,minDate:t.any,monthsPerRow:t.oneOf([3,4]),onAccept:t.func,onChange:t.func,onClose:t.func,onError:t.func,onMonthChange:t.func,onViewChange:t.func,onYearChange:t.func,openTo:t.oneOf(["day","month","year"]),orientation:t.oneOf(["landscape","portrait"]),readOnly:t.bool,reduceAnimations:t.bool,referenceDate:t.any,renderLoading:t.func,shouldDisableDate:t.func,shouldDisableMonth:t.func,shouldDisableYear:t.func,showDaysOutsideCurrentMonth:t.bool,slotProps:t.object,slots:t.object,sx:t.oneOfType([t.arrayOf(t.oneOfType([t.func,t.object,t.bool])),t.func,t.object]),timezone:t.string,value:t.any,view:t.oneOf(["day","month","year"]),viewRenderers:t.shape({day:t.func,month:t.func,year:t.func}),views:t.arrayOf(t.oneOf(["day","month","year"]).isRequired),yearsPerRow:t.oneOf([3,4])};const be=Array(12).fill(0).map((e,r)=>({value:r,label:k.months()[r]})),Se=ue.map((e,r)=>({value:r+1,label:e})),ke=bt(xt,{shouldForwardProp:e=>e!=="dayIsBetween"&&e!=="isFirstDay"&&e!=="isLastDay"})(({theme:e,isFirstDay:r,isLastDay:i,dayIsBetween:y})=>({...y&&{borderRadius:0,backgroundColor:te+"!important"},...r&&{color:e.palette.common.white+"!important",backgroundColor:wt+"!important",borderTopLeftRadius:"50%",borderBottomLeftRadius:"50%"},...i&&{color:e.palette.common.white+"!important",borderTopRightRadius:"50%",borderBottomRightRadius:"50%",backgroundColor:wt+"!important"},"&.Mui-selected":{backgroundColor:"transparent",color:e.palette.common.black,"::after":{content:'""',border:"2px solid "+ee,borderRadius:"50%",padding:"1.5rem",position:"absolute"},"&:hover, &:focus":{backgroundColor:"transparent"}}})),Oe=e=>{const{dateValue:r,highlightedDays:i=[],startDate:y,endDate:g,shiftDays:a=[],...o}=e;if(!r)return n(xt,{...o});const l=i.filter(m=>tt(m,e.day)).length>0,S=tt(y,e.day),c=tt(g,e.day),h=a.filter(m=>tt(m,e.day)).length>0;return n(ke,{...o,disableMargin:!0,dayIsBetween:l,isFirstDay:S,isLastDay:c,selected:h})},vt=()=>{var Ot;const e=Gt(s=>s.user),r=N(St),i=N(it),y=N($t),g=N(Ut),a=kt(),o=se("1",{refetchOnMountOrArgChange:!0}),[l,S]=u.useState(0),[c,h]=u.useState(new Date),[m,j]=u.useState(),[A,K]=u.useState(),[L,v]=u.useState({}),[R,P]=de(),[_,lt]=u.useState([{month:c.getMonth(),year:c.getFullYear(),businessId:"1"},{month:c.getMonth()+1,year:c.getFullYear(),businessId:"1"},{month:c.getMonth()+2,year:c.getFullYear(),businessId:"1"}]),et=Dt(_[0],{refetchOnMountOrArgChange:!0}),st=Dt(_[1],{refetchOnMountOrArgChange:!0}),f=Dt(_[2],{refetchOnMountOrArgChange:!0}),[p,I]=u.useState([]),[B,ct]=u.useState({startDate:k(new Date).format("yyyy-MM-DD"),businessId:"1"}),at=he(B,{refetchOnMountOrArgChange:!0}),[G,ot]=u.useState();u.useEffect(()=>{const{data:s,isError:d,isLoading:D,isSuccess:b,error:T}=o;return a(O(D)),b&&s&&S(s.daysBlock),d&&T&&a(U(V(`${r.t("ERROR_LOADING_DATA")} ${y.t("BUSINESS_INFO")}`,"error"))),()=>Object.keys(W).forEach(w=>Q(w,W[w]))},[o]),u.useEffect(()=>{const{data:s,isLoading:d,isSuccess:D,isError:b,error:T,isFetching:w}=et;a(O(w)),a(O(d)),D&&s&&s.map(X=>{const M=k(X.day,"MM/DD/YYYY").toDate();I(x=>{let E=x;return E.filter(Z=>M===Z).length>0?x:(E.push(M),E)})})},[et]),u.useEffect(()=>{const{data:s,isLoading:d,isSuccess:D,isError:b,error:T,isFetching:w}=st;a(O(w)),a(O(d)),D&&s&&s.map(X=>{const M=k(X.day,"yyyy-MM-DD").toDate();I(x=>{let E=x;return E.filter(Z=>M===Z).length>0?x:(E.push(M),E)})})},[st]),u.useEffect(()=>{const{data:s,isLoading:d,isSuccess:D,isError:b,error:T,isFetching:w}=f;a(O(w)),a(O(d)),D&&s&&s.map(X=>{const M=k(X.day,"yyyy-MM-DD").toDate();I(x=>{let E=x;return E.filter(Z=>M===Z).length>0?x:(E.push(M),E)})})},[f]),u.useEffect(()=>{const{data:s,isLoading:d,isSuccess:D,isError:b,error:T,isFetching:w}=at;a(O(w)),a(O(d)),D&&s&&(j(k(s[0].dailyDate,"yyyy-MM-DD").toDate()),K(k(s[s.length-1].dailyDate,"yyyy-MM-DD").toDate())),b&&T&&a(U(V(`${r.t("ERROR_LOADING_DATA")} ${g.t("USER_SHIFTS")}`,"error")))},[at]);const ut=(s,d)=>{const D=[];let b=s;for(;b<=d;){let T=new Date(b);T.setHours(0,0,0,0),D.push(T),b=k(b).add("d",1).toDate()}return D},W={id:void 0,startDate:"",endDate:"",statusId:1,notes:"",createdByUserId:e.uid,shiftId:(Ot=e.data)==null?void 0:Ot.shiftId},dt=C.object({id:C.number().optional(),startDate:C.string(),endDate:C.string(),statusId:C.number().min(1),createdByUserId:C.number(),shiftId:C.number(),notes:C.string().min(1,i.t("NOTES_REQUIRED"))}),z=Bt({mode:"onChange",defaultValues:W,resolver:Mt(dt)}),{handleSubmit:H,control:ht,formState:ft,setValue:Q,reset:yt}=z,{isValid:gt,errors:mt,isDirty:q}=ft;u.useEffect(()=>{const{isError:s,isLoading:d,isSuccess:D,data:b,error:T}=P;return a(O(d)),D&&b&&(b.status?(setTimeout(()=>{a(U(V(`${i.t("BOOKING")} ${r.t("SAVE_SUCCESSFUL")}`,"success")))},250),a(rt())):(a(U(V(`${i.t(b.message)}`,"warning"))),ot(b))),s&&T&&a(U(V(`${r.t("SAVE_ERROR")} ${i.t("BOOKING")}`,"error"))),()=>ot()},[P]);const $=(s,d)=>{if(!d){let D={...s,endDate:s.startDate};R(D)}yt(s)};u.useEffect(()=>{ct(s=>({...s,startDate:k(c).format("yyyy-MM-DD")}))},[c]),u.useEffect(()=>{m&&A&&(v(s=>({...s,dateValue:c,highlightedDays:ut(m,A),startDate:m,endDate:A,shiftDays:p})),Q("startDate",k(m).format("yyyy-MM-DD")),Q("endDate",k(A).format("yyyy-MM-DD")))},[c,m,A,p]);const Lt=s=>{lt(d=>[{...d[0],month:s.getMonth(),year:s.getFullYear()},{...d[1],month:s.getMonth()+1,year:s.getFullYear()},{...d[2],month:s.getMonth()+2,year:s.getFullYear()}])};return n(oe,{isDirty:q,isValid:gt,actions:G?[{title:i.t("WAITING_LIST"),onClick:H(s=>$(s,!0)),forceEnable:!0},{title:r.t("CANCEL"),onClick:()=>a(rt()),variant:"outlined",forceEnable:!0}]:[{title:i.t("SUBMIT_BLOCK"),onClick:H(s=>$(s,!0))},{title:i.t("SUBMIT_1_DAY"),onClick:H(s=>$(s,!1))},{title:r.t("CANCEL"),onClick:()=>a(rt()),variant:"outlined",forceEnable:!0}],title:`${r.t("NEW")} ${i.t("BOOKING")}`,children:F("div",{className:"flex flex-col w-full",children:[F("div",{className:"flex flex-row items-start",children:[n("span",{className:"font-medium text-12 md:text-18 mx-12 whitespace-nowrap",children:"Selected Date:"}),n("span",{className:"text-12 md:text-16",children:k(m).format("Do MMMM, YYYY")})]}),F("div",{className:"flex flex-row items-start",children:[n("span",{className:"font-medium text-12 md:text-18 mx-12 whitespace-nowrap",children:"Start Date:"}),F("span",{className:"text-12 md:text-16",children:["The holiday block is for ",l," days"]})]}),F("div",{className:"flex flex-col md:flex-row items-center justify-start gap-12 w-[80vw] md:w-[70vw] lg:w-[60vw] xl:w-[40vw]",children:[Object.keys(L).length>0?n(Pt,{dateAdapter:Vt,children:n(Ft,{sx:{".MuiDateCalendar-root":{borderRadius:"20px"}},className:"my-10",value:c,onChange:s=>{p.filter(d=>tt(d,s)).length>0&&h(s)},slots:{day:Oe,toolbar:null},slotProps:{day:L,actionBar:{actions:[]}},showDaysOutsideCurrentMonth:!0,onMonthChange:Lt})}):"",F("div",{className:"flex flex-col w-full gap-12 px-12 pb-24",children:[n(Tt,{className:"font-bold",children:i.t("NOTES_DIALOG_BOX_TITLE")}),n(ae,{control:ht,name:"notes",label:`${i.t("NOTES")}`,errors:mt,multiline:!0,rows:10,InputLabelProps:{shrink:!0},dialog:!0,calendarSpace:!0}),G?n(Tt,{sx:{color:"error.main"},className:"font-bold",children:i.t(G.message)}):""]})]})]})})},Nt=e=>{const{isDialog:r,handleSubmit:i,control:y,errors:g,setValue:a}=e,o=N(St),l=N(it),S=kt(),c=h=>F(Yt,{children:[n(Jt,{control:y,name:"year",label:o.t("YEAR"),errors:g,filter:h.filter,dialog:h.dialog,col2:h.isGrid,InputLabelProps:{shrink:!0},placeholder:o.t("YEAR"),views:["year"]}),n(At,{control:y,name:"month",label:o.t("MONTH"),errors:g,filter:h.filter,dialog:h.dialog,col2:h.isGrid,InputLabelProps:{shrink:!0},type:"number",placeholder:o.t("MONTH"),selectList:be}),n(At,{control:y,name:"bookingStatus",label:l.t("BOOKING_STATUS"),errors:g,filter:h.filter,dialog:h.dialog,col2:h.isGrid,InputLabelProps:{shrink:!0},type:"number",placeholder:l.t("BOOKING_STATUS"),selectList:Se})]});return r?n(re,{title:o.t("FILTER")+" "+l.t("MY_BOOKINGS"),actions:[{title:o.t("FILTER"),onClick:i}],children:n("div",{className:"gird md:grid-cols-4 gap-12",children:c({filter:!1,dialog:!0,isGrid:!0})})}):n(le,{hasAddButton:!0,handleFilterClick:i,customAddTitle:`${o.t("NEW")} ${l.t("BOOKING")}`,handleAddClick:()=>S(nt({children:n(vt,{})})),children:c({filter:!0,dialog:!1})})},Ce=()=>[{key:"startDate",title:"START_DATE",isConstantTranslation:!0,canBeSorted:!0},{key:"endDate",title:"END_DATE",isConstantTranslation:!0,canBeSorted:!0},{key:"status",title:"STATUS",isConstantTranslation:!0,canBeSorted:!0,colorCoded:!0,colorCodeLink:"statusId",colors:fe,customSortVar:"statusId"},{key:"statusId",title:"STATUS",isHidden:!0},{key:"waitingListPosition",title:"POSITION",isConstantTranslation:!0}],Ie=e=>[{label:"VIEW",icon:n(jt,{className:"pointer-events-none",size:24,children:"material-outline:remove_red_eye"}),iconColor:"primary",onClick:e}],Te=()=>{const[e,r]=u.useState({page:1,pageSize:Et,sortBy:"startDate",sortOrder:J.ASCENDING,bookingStatus:1}),[i,y]=u.useState({currentPage:1,pageSize:Et,totalCount:0,totalPages:0}),g=N(St),a=N(it),o=kt(),[l,S]=u.useState([]),[c,h]=u.useState(0),m=ye(e,{refetchOnMountOrArgChange:!0});u.useEffect(()=>{const{data:f,isLoading:p,isSuccess:I,isError:B,error:ct,isFetching:at}=m;if(o(O(at)),o(O(p)),I&&f){const{totalCount:G,totalPages:ot,currentPage:ut,data:W,pageSize:dt}=f;y(z=>({...z,totalCount:G,totalPages:ot,currentPage:ut,pageSize:dt})),W.map(z=>{const{id:H,startDate:ht,endDate:ft,status:Q,waitingListPosition:yt,waitingListSince:gt,statusId:mt}=z;S(q=>{const $=q;return $.push({id:H,actions:!0,startDate:ht,endDate:ft,status:Q,statusId:mt,waitingListSince:gt,waitingListPosition:yt}),$}),h(q=>e.filter?q:G)})}return B&&ct&&o(U(V(`${g.t("ERROR_LOADING_DATA")} ${a.t("BOOKING")}`,"error"))),()=>S([])},[m]);const j={year:new Date,month:new Date().getMonth(),bookingStatus:2},A=C.object({year:C.date().optional(),month:C.number().optional(),bookingStatus:C.number()}),K=Bt({mode:"onChange",defaultValues:j,resolver:Mt(A)}),{handleSubmit:L,control:v,formState:R,setValue:P}=K,{errors:_}=R,lt=(f,p)=>{r(I=>({...I,page:p+1}))},et=(f,p)=>{r(I=>{let B;return I.sortBy===p?I.sortOrder===J.ASCENDING?B=J.DESCENDING:B=J.ASCENDING:B=J.ASCENDING,{...I,sortBy:p,sortOrder:B}})},st=f=>{const{id:p}=f.target;o(nt({children:n(ge,{bookingId:p})}))};return F(ce,{title:`${g.t("FILTER")} ${a.t("MY_BOOKINGS")}`,hasFilterButton:!0,hasAddButton:!0,customAddTitle:`${g.t("New")} ${a.t("BOOKING")}`,handleClick:()=>o(nt({children:n(vt,{})})),handleFilterClick:()=>o(nt({children:n(Nt,{isDialog:!0,control:v,handleSubmit:L(f=>{r(p=>({...p,year:f.year.getFullYear(),month:f.month+1,bookingStatus:f.bookingStatus-1})),o(rt())}),setValue:P,errors:_})})),children:[n(Nt,{control:v,handleSubmit:L(f=>{r(p=>({...p,year:f.year.getFullYear(),month:f.month+1,bookingStatus:f.bookingStatus-1}))}),setValue:P,errors:_}),n(ne,{sortBy:e==null?void 0:e.sortBy,sortOrder:e==null?void 0:e.sortOrder,showId:!1,tableLabel:a.t("BOOKINGS"),tableHeadings:Ce(),t:a.t,hasActions:!0,tableInfo:i,tableRows:l,handlePageChange:lt,handleSortChange:et,hasFilterButton:!0,tableActions:Ie(st)})]})},Ee=bt(ie)(({theme:e})=>({...Kt(e)})),Fe=()=>{const{t:e}=N(it);return n(Ee,{header:n(Wt,{title:e("TITLE")}),scroll:"page",content:n(Te,{})})};export{Fe as default};
//# sourceMappingURL=Booking-D1m9hTvj.js.map
